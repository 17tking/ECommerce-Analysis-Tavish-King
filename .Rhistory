#gradient of colors
scale_fill_gradientn(colors = c("forestgreen", "palegreen2", "yellow3",
"lightcoral", "darkred"),
name = "",
label = label_number(suffix = " days"))+
#adjusting map location on plot
coord_sf(xlim = c(-76, -34), ylim = c(-33, 4.5), expand = FALSE)+
#plot theming
theme_map()+
theme(#legend adjustments
legend.position = "top",
legend.justification = 0.5,
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1.75, "cm"),
legend.text = element_text(size = 8),
legend.margin = margin(),
#Increase title size and adjust alignment
plot.title = element_text(size = 18, hjust = 0.5, face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, face = "italic"))+
#labels
labs(title = "Delivery Speed in Brazil",
subtitle = "Longer delivery times could limit additional revenue",
caption = "Data is from 1/2017 to 9/2018")
#save plot
ggsave(kpi3_brazil_delivery_map,
filename = "R/plots/kpi3_brazil_delivery_map.jpg",
height = 5,
width = 6)
## Average Delivery Days for Brazil States - Choropleth Map
kpi3_brazil_delivery_map <- ggplot(tot_state_sales)+
geom_sf(aes(fill = avg_delivery_days),
lwd = 0.5,
color = "white")+
geom_sf_text(aes(label = abbrev_state),
size = 2.8,
color = "black")+
#insight annotation
annotate("text",
x = -76,
y = -22,
label = "Northern Brazil is \ndominated by the Amazon \nrainforest, where dense \njungle terrain and \nlimited road infrastructure \npose significant \nchallenges to delivery \nlogistics and \naccess to remote \nareas.",
hjust = 0,
size = 4,
color = "darkred")+
#gradient of colors
scale_fill_gradientn(colors = c("forestgreen", "palegreen2", "yellow3",
"lightcoral", "darkred"),
name = "",
label = label_number(suffix = " days"))+
#adjusting map location on plot
coord_sf(xlim = c(-76, -34), ylim = c(-33, 4.5), expand = FALSE)+
#plot theming
theme_map()+
theme(#legend adjustments
legend.position = "top",
legend.justification = 0.5,
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1.75, "cm"),
legend.text = element_text(size = 8),
legend.margin = margin(),
#Increase title size and adjust alignment
plot.title = element_text(size = 18, hjust = 0.5, face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, face = "italic"))+
#labels
labs(title = "Delivery Speed in Brazil",
subtitle = "Longer delivery times could limit additional revenue",
caption = "Data is from 1/2017 to 9/2018")
#save plot
ggsave(kpi3_brazil_delivery_map,
filename = "R/plots/kpi3_brazil_delivery_map.jpg",
height = 5,
width = 6)
## Average Delivery Days for Brazil States - Choropleth Map
kpi3_brazil_delivery_map <- ggplot(tot_state_sales)+
geom_sf(aes(fill = avg_delivery_days),
lwd = 0.5,
color = "white")+
geom_sf_text(aes(label = abbrev_state),
size = 2.8,
color = "black")+
#insight annotation
annotate("text",
x = -76,
y = -22,
label = "Northern Brazil is \ndominated by the Amazon \nrainforest, where dense \njungle terrain and \nlimited road infrastructure \npose significant \nchallenges to delivery \nlogistics and \naccess to remote \nareas.",
hjust = 0,
size = 2,
color = "darkred")+
#gradient of colors
scale_fill_gradientn(colors = c("forestgreen", "palegreen2", "yellow3",
"lightcoral", "darkred"),
name = "",
label = label_number(suffix = " days"))+
#adjusting map location on plot
coord_sf(xlim = c(-76, -34), ylim = c(-33, 4.5), expand = FALSE)+
#plot theming
theme_map()+
theme(#legend adjustments
legend.position = "top",
legend.justification = 0.5,
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1.75, "cm"),
legend.text = element_text(size = 8),
legend.margin = margin(),
#Increase title size and adjust alignment
plot.title = element_text(size = 18, hjust = 0.5, face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, face = "italic"))+
#labels
labs(title = "Delivery Speed in Brazil",
subtitle = "Longer delivery times could limit additional revenue",
caption = "Data is from 1/2017 to 9/2018")
#save plot
ggsave(kpi3_brazil_delivery_map,
filename = "R/plots/kpi3_brazil_delivery_map.jpg",
height = 5,
width = 6)
## Average Delivery Days for Brazil States - Choropleth Map
kpi3_brazil_delivery_map <- ggplot(tot_state_sales)+
geom_sf(aes(fill = avg_delivery_days),
lwd = 0.5,
color = "white")+
geom_sf_text(aes(label = abbrev_state),
size = 2.8,
color = "black")+
#insight annotation
annotate("text",
x = -76,
y = -22,
label = "Northern Brazil is \ndominated by the Amazon \nrainforest, where dense \njungle terrain and \nlimited road infrastructure \npose significant \nchallenges to delivery \nlogistics and \naccess to remote \nareas.",
hjust = 0,
size = 3,
color = "darkred")+
#gradient of colors
scale_fill_gradientn(colors = c("forestgreen", "palegreen2", "yellow3",
"lightcoral", "darkred"),
name = "",
label = label_number(suffix = " days"))+
#adjusting map location on plot
coord_sf(xlim = c(-76, -34), ylim = c(-33, 4.5), expand = FALSE)+
#plot theming
theme_map()+
theme(#legend adjustments
legend.position = "top",
legend.justification = 0.5,
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1.75, "cm"),
legend.text = element_text(size = 8),
legend.margin = margin(),
#Increase title size and adjust alignment
plot.title = element_text(size = 18, hjust = 0.5, face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, face = "italic"))+
#labels
labs(title = "Delivery Speed in Brazil",
subtitle = "Longer delivery times could limit additional revenue",
caption = "Data is from 1/2017 to 9/2018")
#save plot
ggsave(kpi3_brazil_delivery_map,
filename = "R/plots/kpi3_brazil_delivery_map.jpg",
height = 5,
width = 6)
## Average Delivery Days for Brazil States - Choropleth Map
kpi3_brazil_delivery_map <- ggplot(tot_state_sales)+
geom_sf(aes(fill = avg_delivery_days),
lwd = 0.5,
color = "white")+
geom_sf_text(aes(label = abbrev_state),
size = 2.8,
color = "black")+
#insight annotation
annotate("text",
x = -75,
y = -22,
label = "Northern Brazil is \ndominated by the Amazon \nrainforest, where dense \njungle terrain and \nlimited road infrastructure \npose significant \nchallenges to delivery \nlogistics and \naccess to remote \nareas.",
hjust = 0,
size = 3,
color = "darkred")+
#gradient of colors
scale_fill_gradientn(colors = c("forestgreen", "palegreen2", "yellow3",
"lightcoral", "darkred"),
name = "",
label = label_number(suffix = " days"))+
#adjusting map location on plot
coord_sf(xlim = c(-76, -34), ylim = c(-33, 4.5), expand = FALSE)+
#plot theming
theme_map()+
theme(#legend adjustments
legend.position = "top",
legend.justification = 0.5,
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1.75, "cm"),
legend.text = element_text(size = 8),
legend.margin = margin(),
#Increase title size and adjust alignment
plot.title = element_text(size = 18, hjust = 0.5, face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, face = "italic"))+
#labels
labs(title = "Delivery Speed in Brazil",
subtitle = "Longer delivery times could limit additional revenue",
caption = "Data is from 1/2017 to 9/2018")
#save plot
ggsave(kpi3_brazil_delivery_map,
filename = "R/plots/kpi3_brazil_delivery_map.jpg",
height = 5,
width = 6)
## Average Delivery Days for Brazil States - Choropleth Map
kpi3_brazil_delivery_map <- ggplot(tot_state_sales)+
geom_sf(aes(fill = avg_delivery_days),
lwd = 0.5,
color = "white")+
geom_sf_text(aes(label = abbrev_state),
size = 2.8,
color = "black")+
#insight annotation
annotate("text",
x = -75,
y = -22,
label = "Northern Brazil is \ndominated by the Amazon \nrainforest, where dense \njungle terrain and limited \nroad infrastructure pose \nsignificant challenges to \ndelivery logistics and access \nto remote \nareas.",
hjust = 0,
size = 3,
color = "darkred")+
#gradient of colors
scale_fill_gradientn(colors = c("forestgreen", "palegreen2", "yellow3",
"lightcoral", "darkred"),
name = "",
label = label_number(suffix = " days"))+
#adjusting map location on plot
coord_sf(xlim = c(-76, -34), ylim = c(-33, 4.5), expand = FALSE)+
#plot theming
theme_map()+
theme(#legend adjustments
legend.position = "top",
legend.justification = 0.5,
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1.75, "cm"),
legend.text = element_text(size = 8),
legend.margin = margin(),
#Increase title size and adjust alignment
plot.title = element_text(size = 18, hjust = 0.5, face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, face = "italic"))+
#labels
labs(title = "Delivery Speed in Brazil",
subtitle = "Longer delivery times could limit additional revenue",
caption = "Data is from 1/2017 to 9/2018")
#save plot
ggsave(kpi3_brazil_delivery_map,
filename = "R/plots/kpi3_brazil_delivery_map.jpg",
height = 5,
width = 6)
## Average Delivery Days for Brazil States - Choropleth Map
kpi3_brazil_delivery_map <- ggplot(tot_state_sales)+
geom_sf(aes(fill = avg_delivery_days),
lwd = 0.5,
color = "white")+
geom_sf_text(aes(label = abbrev_state),
size = 2.8,
color = "black")+
#insight annotation
annotate("text",
x = -75,
y = -22,
label = "Northern Brazil is \ndominated by the Amazon \nrainforest, where dense \njungle terrain and limited \nroad infrastructure pose \nsignificant challenges to \ndelivery logistics and access \nto remote \nareas.",
hjust = 0,
size = 3.2,
color = "darkred")+
#gradient of colors
scale_fill_gradientn(colors = c("forestgreen", "palegreen2", "yellow3",
"lightcoral", "darkred"),
name = "",
label = label_number(suffix = " days"))+
#adjusting map location on plot
coord_sf(xlim = c(-76, -34), ylim = c(-33, 4.5), expand = FALSE)+
#plot theming
theme_map()+
theme(#legend adjustments
legend.position = "top",
legend.justification = 0.5,
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1.75, "cm"),
legend.text = element_text(size = 8),
legend.margin = margin(),
#Increase title size and adjust alignment
plot.title = element_text(size = 18, hjust = 0.5, face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, face = "italic"))+
#labels
labs(title = "Delivery Speed in Brazil",
subtitle = "Longer delivery times could limit additional revenue",
caption = "Data is from 1/2017 to 9/2018")
#save plot
ggsave(kpi3_brazil_delivery_map,
filename = "R/plots/kpi3_brazil_delivery_map.jpg",
height = 5,
width = 6)
## Average Delivery Days for Brazil States - Choropleth Map
kpi3_brazil_delivery_map <- ggplot(tot_state_sales)+
geom_sf(aes(fill = avg_delivery_days),
lwd = 0.5,
color = "white")+
geom_sf_text(aes(label = abbrev_state),
size = 2.8,
color = "black")+
#insight annotation
annotate("text",
x = -75.5,
y = -22,
label = "Northern Brazil is \ndominated by the Amazon \nrainforest, where dense \njungle terrain and limited \nroad infrastructure pose \nsignificant challenges to \ndelivery logistics and access \nto remote \nareas.",
hjust = 0,
size = 3.2,
color = "darkred")+
#gradient of colors
scale_fill_gradientn(colors = c("forestgreen", "palegreen2", "yellow3",
"lightcoral", "darkred"),
name = "",
label = label_number(suffix = " days"))+
#adjusting map location on plot
coord_sf(xlim = c(-76, -34), ylim = c(-33, 4.5), expand = FALSE)+
#plot theming
theme_map()+
theme(#legend adjustments
legend.position = "top",
legend.justification = 0.5,
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1.75, "cm"),
legend.text = element_text(size = 8),
legend.margin = margin(),
#Increase title size and adjust alignment
plot.title = element_text(size = 18, hjust = 0.5, face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, face = "italic"))+
#labels
labs(title = "Delivery Speed in Brazil",
subtitle = "Longer delivery times could limit additional revenue",
caption = "Data is from 1/2017 to 9/2018")
#save plot
ggsave(kpi3_brazil_delivery_map,
filename = "R/plots/kpi3_brazil_delivery_map.jpg",
height = 5,
width = 6)
## Average Delivery Days for Brazil States - Choropleth Map
kpi3_brazil_delivery_map <- ggplot(tot_state_sales)+
geom_sf(aes(fill = avg_delivery_days),
lwd = 0.5,
color = "white")+
geom_sf_text(aes(label = abbrev_state),
size = 2.8,
color = "black")+
#insight annotation
annotate("text",
x = -75.5,
y = -22,
label = "Northern Brazil is \ndominated by the Amazon \nrainforest, where dense \njungle terrain and limited \nroad infrastructure pose \nsignificant challenges to \ndelivery logistics and access \nto remote areas.",
hjust = 0,
size = 3.2,
color = "darkred")+
#gradient of colors
scale_fill_gradientn(colors = c("forestgreen", "palegreen2", "yellow3",
"lightcoral", "darkred"),
name = "",
label = label_number(suffix = " days"))+
#adjusting map location on plot
coord_sf(xlim = c(-76, -34), ylim = c(-33, 4.5), expand = FALSE)+
#plot theming
theme_map()+
theme(#legend adjustments
legend.position = "top",
legend.justification = 0.5,
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1.75, "cm"),
legend.text = element_text(size = 8),
legend.margin = margin(),
#Increase title size and adjust alignment
plot.title = element_text(size = 18, hjust = 0.5, face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, face = "italic"))+
#labels
labs(title = "Delivery Speed in Brazil",
subtitle = "Longer delivery times could limit additional revenue",
caption = "Data is from 1/2017 to 9/2018")
#save plot
ggsave(kpi3_brazil_delivery_map,
filename = "R/plots/kpi3_brazil_delivery_map.jpg",
height = 5,
width = 6)
## Average Delivery Days for Brazil States - Choropleth Map
kpi3_brazil_delivery_map <- ggplot(tot_state_sales)+
geom_sf(aes(fill = avg_delivery_days),
lwd = 0.5,
color = "white")+
geom_sf_text(aes(label = abbrev_state),
size = 2.8,
color = "black")+
#insight annotation
annotate("text",
x = -75,
y = -22,
label = "Northern Brazil is \ndominated by the Amazon \nrainforest, where dense \njungle terrain and limited \nroad infrastructure pose \nsignificant challenges to \ndelivery logistics and access \nto remote areas.",
hjust = 0,
size = 3.2,
color = "darkred")+
#gradient of colors
scale_fill_gradientn(colors = c("forestgreen", "palegreen2", "yellow3",
"lightcoral", "darkred"),
name = "",
label = label_number(suffix = " days"))+
#adjusting map location on plot
coord_sf(xlim = c(-76, -34), ylim = c(-33, 4.5), expand = FALSE)+
#plot theming
theme_map()+
theme(#legend adjustments
legend.position = "top",
legend.justification = 0.5,
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1.75, "cm"),
legend.text = element_text(size = 8),
legend.margin = margin(),
#Increase title size and adjust alignment
plot.title = element_text(size = 18, hjust = 0.5, face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, face = "italic"))+
#labels
labs(title = "Delivery Speed in Brazil",
subtitle = "Longer delivery times could limit additional revenue",
caption = "Data is from 1/2017 to 9/2018")
#save plot
ggsave(kpi3_brazil_delivery_map,
filename = "R/plots/kpi3_brazil_delivery_map.jpg",
height = 5,
width = 6)
## Average Delivery Days for Brazil States - Choropleth Map
kpi3_brazil_delivery_map <- ggplot(tot_state_sales)+
geom_sf(aes(fill = avg_delivery_days),
lwd = 0.5,
color = "white")+
geom_sf_text(aes(label = abbrev_state),
size = 2.8,
color = "black")+
#insight annotation
annotate("text",
x = -75,
y = -22,
label = "Northern Brazil is \ndominated by the Amazon \nrainforest, where dense \njungle terrain and limited \nroad infrastructure pose \nsignificant challenges to \ndelivery logistics and access \nto remote areas.",
hjust = 0,
size = 3.2,
color = "darkred")+
#gradient of colors
scale_fill_gradientn(colors = c("forestgreen", "palegreen2", "yellow3",
"lightcoral", "darkred"),
name = "",
label = label_number(suffix = " days"))+
#adjusting map location on plot
coord_sf(xlim = c(-76, -34), ylim = c(-33, 4.5), expand = FALSE)+
#plot theming
theme_map()+
theme(#legend adjustments
legend.position = "top",
legend.justification = 0.5,
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1.75, "cm"),
legend.text = element_text(size = 8),
legend.margin = margin(),
#Increase title size and adjust alignment
plot.title = element_text(size = 18, hjust = 0.5, face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, face = "italic"))+
#labels
labs(title = "Delivery Speed in Brazil",
subtitle = "Longer delivery times could limit additional revenue",
caption = "Data is from 1/2017 to 9/2018")
#save plot
ggsave(kpi3_brazil_delivery_map,
filename = "R/plots/kpi3_brazil_delivery_map.jpg",
height = 5,
width = 6)
## Average Order Value by State - Choropleth Map
kpi3_brazil_aov_map <- ggplot(tot_state_sales)+
geom_sf(aes(fill = aov),
lwd = 0.5,
color = "white")+
geom_sf_text(aes(label = abbrev_state),
size = 2.8,
color = "black")+
#gradient of colors
scale_fill_gradientn(colors = c("lightyellow2", "coral", "coral4"),
name = "",
label = label_number(prefix = "$"))+
#insight annotation
annotate("text",
x = -76,
y = -22,
label = "Average order values \nin rural states \nare on par with urban \nstates, but delivery times \nare slow (> 2 weeks).",
hjust = 0,
size = 4,
color = "coral4")+
#adjusting map location on plot
coord_sf(xlim = c(-76, -34), ylim = c(-33, 4.5), expand = FALSE)+
#plot theming
theme_map()+
theme(#legend adjustments
legend.position = "top",
legend.justification = 0.5,
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1.75, "cm"),
legend.text = element_text(size = 8),
legend.margin = margin(),
#Increase title size and adjust alignment
plot.title = element_text(size = 18, hjust = 0.5, face = "bold"),
plot.subtitle = element_text(size = 12, hjust = 0.5, face = "italic"))+
#labels
labs(title = "Average Order Values in Brazil",
subtitle = "Spending in undeserved regions show appetite \nfor expanded e-commerce access",
caption = "Data is from 1/2017 to 9/2018")
#save plot
ggsave(kpi3_brazil_aov_map,
filename = "R/plots/kpi3_brazil_aov_map.jpg",
height = 5,
width = 6)
#####################################
